# Global configuration
global:
  namespace: dns-dhcp

  # Image pull secrets for private registries (e.g., GitHub Container Registry)
  # Create secret: kubectl create secret docker-registry ghcr-token \
  #   --docker-server=ghcr.io \
  #   --docker-username=YOUR_USERNAME \
  #   --docker-password=YOUR_GITHUB_TOKEN \
  #   --docker-email=YOUR_EMAIL \
  #   -n dns-dhcp
  imagePullSecrets: []
  # imagePullSecrets:
  #   - name: ghcr-token
  
  # Storage configuration
  storage:
    className: "local-path"
  
  # Recursive resolver (always runs if DNS enabled)
  resolver:
    type: unbound
  
  # Authoritative DNS for local zones
  authDNS:
    type: bind  # "bind" or "knot"
    service: 127.0.0.1
    port: 5353
  
  # Container images
  images:
    unbound: crazymax/unbound:latest
    bind: internetsystemsconsortium/bind9:latest
    knot: cznic/knot:latest
    keaDhcp: ghcr.io/mabels/kea-dhcp-dns:latest
    keaDdns: ghcr.io/mabels/kea-dhcp-dns:latest
    storkServer: ghcr.io/mabels/kea-dhcp-dns/stork-server:latest
    storkAgent: ghcr.io/mabels/kea-dhcp-dns/stork-agent:latest

# Service toggles (per segment)
services:
  dns:
    enabled: true
  dhcp:
    enabled: true

# Stork monitoring configuration
stork:
  enabled: true
  
  # Stork Server (central monitoring UI)
  # Deploy this ONCE separately with segments: []
  server:
    enabled: false  # Enable only for server deployment
    replicas: 1
    port: 8080
    
    # PostgreSQL database connection
    database:
      host: postgresql.postgresql.svc.cluster.local
      port: 5432
      name: stork
      user: stork_user
      # Password from secret
      passwordSecret:
        name: stork-db-credentials
        key: password
    
    resources:
      requests:
        memory: 128Mi
        cpu: 100m
      limits:
        memory: 512Mi
        cpu: 500m
  
  # Ingress for Stork Server Web UI
  ingress:
    enabled: false  # Enable for server deployment
    className: ""   # e.g., "nginx" or "traefik"
    
    # Hosts for the ingress
    hosts:
      - stork.example.com
    
    # Annotations (e.g., for cert-manager)
    annotations:
      # cert-manager.io/cluster-issuer: "letsencrypt-prod"
      # external-dns.alpha.kubernetes.io/hostname: "stork.example.com"
    
    # TLS configuration
    tls:
      enabled: true
      # Certificate secrets are auto-generated from hostnames
      # Format: hostname with dots replaced by dashes
      # Example: stork.example.com -> stork-example-com
    
    # Path configuration
    path: /
    pathType: Prefix
  
  # Stork Agent (runs as sidecar in each segment pod)
  # This is the default for all segments
  agent:
    enabled: true  # Default: enable for all segments
    
    resources:
      requests:
        memory: 64Mi
        cpu: 50m
      limits:
        memory: 256Mi
        cpu: 200m

# Network segments
# Each segment gets its own StatefulSet with DNS/DHCP services
# Leave empty (segments: []) when deploying only Stork Server
segments:
  - name: "128"
    domain: seg128.local
    
    # IPv4 configuration
    ipv4:
      network: 192.168.128.0/24
      dns: 192.168.128.5
      dhcp: 192.168.128.5
      gateway: 192.168.128.1
      dhcpRange:
        start: 192.168.128.100
        end: 192.168.128.200
    
    # IPv6 configuration  
    ipv6:
      network: fd00:128::/64
      dns: fd00:128::5
      dhcp: fd00:128::5
      gateway: fd00:128::1
      dhcpRange:
        start: fd00:128::1000
        end: fd00:128::2000
    
    # Upstream DNS servers
    upstream:
      - 1.1.1.1
      - 8.8.8.8
    
    # Optional: Override Stork Agent for this segment
    # storkAgent:
    #   enabled: false  # Disable agent for this specific segment


# Network configuration for routing
# These values depend on your Kubernetes cluster configuration
network:
  # Pod CIDR - pods are assigned IPs from this range
  # K3s default: 10.42.0.0/16
  # kubeadm default: 10.244.0.0/16
  # GKE: 10.0.0.0/14
  podCIDR: "10.42.0.0/16"
  
  # Service CIDR - cluster services get IPs from this range
  # K3s default: 10.43.0.0/16
  # kubeadm default: 10.96.0.0/12
  # GKE: 10.4.0.0/14
  serviceCIDR: "10.43.0.0/16"
  
  # Pod network gateway - first IP in the pod network
  # Usually .1 of the pod network
  podGateway: "10.42.0.1"
